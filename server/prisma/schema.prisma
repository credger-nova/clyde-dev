generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Unit {
  status                 String?
  unitNumber             String           @id @map("unit_number")
  customer               String?
  location               String?
  county                 String?
  state                  String?
  engine                 String?
  engineFamily           String?          @map("engine_family")
  engineSerialNum        String?          @map("engine_serial_num")
  afr                    String?
  catalyst               String?
  catalystMM             String?          @map("catalyst_mm")
  oemHP                  Float?           @map("oem_hp")
  novaHP                 Float?           @map("nova_hp")
  engineRPM              Float?           @map("engine_rpm")
  frameRPM               Float?           @map("frame_rpm")
  compressorFrame        String?          @map("compressor_frame")
  compressorFrameFamily  String?          @map("compressor_frame_family")
  compressorFrameSN      String?          @map("compressor_frame_sn")
  stages                 String?
  cylinderSize           String?          @map("cylinder_size")
  packageMfgDate         DateTime?        @map("package_mfg_date") @db.Timestamp(6)
  engineMfgDate          DateTime?        @map("engine_mfg_date") @db.Timestamp(6)
  zeroHourDate           DateTime?        @map("zero_hour_date") @db.Timestamp(6)
  compressorFrameRebuild DateTime?        @map("compressor_frame_rebuild") @db.Timestamp(6)
  topEnd                 DateTime?        @map("top_end") @db.Timestamp(6)
  oilProvider            String?          @map("oil_provider")
  telemetry              String?
  coordinates            String?
  trailerUnit            String?          @map("trailer_unit")
  unitSetDate            DateTime?        @map("unit_set_date") @db.Timestamp(6)
  billingStartDate       DateTime?        @map("billing_start_date") @db.Timestamp(6)
  billingEndDate         DateTime?        @map("billing_end_date") @db.Timestamp(6)
  lastBillingDate        DateTime?        @map("last_billing_date") @db.Timestamp(6)
  onOffContract          String?          @map("on_off_contract")
  mtmLastPriceIncrease   String?          @map("mtm_last_price_increase")
  salesperson            String?
  contractTypeTax        String?          @map("contract_type_tax")
  contractTypeOil        String?          @map("contract_type_oil")
  monthlyRate            Float?           @map("monthly_rate")
  recurringDiscount      Float?           @map("recurring_discount")
  salesTax               Float?           @map("sales_tax")
  adValoremHeit          Float?           @map("ad_valorem_heit")
  netRevenue             Float?           @map("net_revenue")
  dayRate                String?          @map("day_rate")
  origin                 String?
  acqEffDate             DateTime?        @map("acq_eff_date") @db.Timestamp(6)
  ownedLeased            String?          @map("owned_leased")
  operationalRegion      String?          @map("operational_region")
  financeRegion          String?          @map("finance_region")
  unitProfileUpdateDate  DateTime?        @map("unit_profile_update_date") @db.Timestamp(6)
  financialSku           String?          @map("financial_sku")
  oemHPTranche           String?          @map("oem_hp_tranche")
  bdComments             String?          @map("bd_comments")
  opsComments            String?          @map("ops_comments")
  setWeek                String?          @map("set_week")
  releaseWeek            String?          @map("release_week")
  assignedTechnician     String?          @map("assigned_technician")
  assignedManager        String?          @map("assigned_manager")
  assignedDirector       String?          @map("assigned_director")
  parameters             Parameter[]
  weeklyDowntimes        WeeklyDowntime[]
  partsReqs              PartsReq[]

  @@map("unit")
}

model Parameter {
  unitNumber String    @map("unit_number")
  name       String
  value      String?
  timestamp  DateTime? @db.Timestamptz(6)
  unit       Unit?     @relation(fields: [unitNumber], references: [unitNumber], onDelete: Cascade)

  @@id([unitNumber, name])
  @@map("parameter")
}

model WeeklyDowntime {
  unitNumber String @map("unit_number")
  week       String
  ma         Float
  dtHours    Float  @map("dt_hours")
  unit       Unit?  @relation(fields: [unitNumber], references: [unitNumber], onDelete: Cascade)

  @@id([unitNumber, week])
  @@map("weekly_downtime")
}

model PartsReqRow {
  id          String    @id @default(uuid())
  qty         Int
  itemNumber  String    @map("item_number")
  description String?
  cost        String?
  partsReq    PartsReq? @relation(fields: [partsReqId], references: [id], onDelete: Cascade)
  partsReqId  Int?      @map("parts_req_id")

  @@map("parts_req_row")
}

model PartsReq {
  id         Int           @id @default(autoincrement())
  requester  String
  contact    String        @default("")
  date       DateTime      @db.Timestamptz(6)
  afe        String?
  so         String?
  unitNumber String?       @map("unit_number")
  truck      String?
  urgency    String
  orderType  String        @map("order_type")
  pickup     String        @default("")
  region     String
  parts      PartsReqRow[]
  comments   Comment[]
  status     String
  updated    DateTime      @db.Timestamptz(6)
  unit       Unit?         @relation(fields: [unitNumber], references: [unitNumber], onDelete: Cascade)
  files      File[]

  @@map("parts_req")
}

model Comment {
  id         String    @id @default(uuid())
  comment    String
  name       String
  timestamp  DateTime  @db.Timestamptz(6)
  partsReq   PartsReq? @relation(fields: [partsReqId], references: [id], onDelete: Cascade)
  partsReqId Int?      @map("parts_req_id")

  @@map("comment")
}

model File {
  id         String    @id @default(uuid())
  name       String
  isDeleted  Boolean   @default(false) @map("is_deleted")
  partsReq   PartsReq? @relation(fields: [partsReqId], references: [id], onDelete: Cascade)
  partsReqId Int?      @map("parts_req_id")

  @@map("file")
}
